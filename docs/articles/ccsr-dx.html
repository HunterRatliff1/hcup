<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="hcup">
<title>CCSR for ICD-10-CM Diagnosis Codes • hcup</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="CCSR for ICD-10-CM Diagnosis Codes">
<meta property="og:description" content="hcup">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hcup</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ccsr-dx.html">CCSR for ICD-10-CM Diagnosis Codes</a>
    <a class="dropdown-item" href="../articles/procedures.html">Procedures with ICD-10-PCS</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>CCSR for ICD-10-CM Diagnosis Codes</h1>
            
      
      
      <div class="d-none name"><code>ccsr-dx.Rmd</code></div>
    </div>

    
    
<p>The <a href="https://www.hcup-us.ahrq.gov/toolssoftware/ccsr/ccsr_archive.jsp#ccsr" class="external-link">Clinical Classifications Software Refined (CCSR) software</a> for ICD-10-CM diagnosis codes provides both one-to-one mapping (<code><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1()</a></code>) and one-to-many mapping (<code><a href="../reference/ccsr_dx.html">ccsr_dx()</a></code>) to CCSR categories. The one-to-many mapping is necessary because many ICD-10 codes span multiple meaningful categories, and the identification of all conditions related to a diagnosis code would be lost by categorizing some ICD-10-CM codes into a single category.</p>
<div class="section level2">
<h2 id="a-simple-demonstration">A simple demonstration<a class="anchor" aria-label="anchor" href="#a-simple-demonstration"></a>
</h2>
<p>For example, consider the code <strong>I11.0</strong> (<em>Hypertensive heart disease with heart failure</em>) which encompasses both <strong>heart failure</strong> (CCSR category CIR019) and <strong>hypertension with complications</strong> (CIR008). Classifying this code as heart failure alone would miss meaningful information, but on the other hand, some analyses require mutually exclusive categorization.</p>
<p>The <code><a href="../reference/ccsr_dx.html">ccsr_dx()</a></code> function identifies all CCSR categories associated with an ICD-10 diagnosis code. Each ICD-10 code can have one or more CCSR category. In the example used above, I11.0 has two CSSR categories, so the function returns a character vector of two CCSR categories</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hunterratliff1.github.io/hcup" class="external-link">hcup</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/ccsr_dx.html">ccsr_dx</a></span><span class="op">(</span><span class="st">"I110"</span><span class="op">)</span>
<span class="co">#&gt; [1] "CIR008" "CIR019"</span>
<span class="fu"><a href="../reference/ccsr_dx.html">ccsr_dx</a></span><span class="op">(</span><span class="st">"I110"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/explain_ccsr.html">explain_ccsr</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] "Hypertension with complications and secondary hypertension"</span>
<span class="co">#&gt; [2] "Heart failure"</span></code></pre></div>
<p>If we need to do one-to-one mapping (e.g. descriptive statistics on the number of hospital discharges), we use <code><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1()</a></code>. Importantly, this algorithm is only valid for the principal diagnosis (for inpatient records) or the first listed diagnosis code (for outpatient data)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1</a></span><span class="op">(</span><span class="st">"I110"</span>, setting <span class="op">=</span> <span class="st">"inpatient"</span><span class="op">)</span>
<span class="co">#&gt; `setting = inpatient` only applies to the principal/first listed diagnosis</span>
<span class="co">#&gt; <span style="color: #555555;">This message is displayed once every 8 hours.</span></span>
<span class="co">#&gt; [1] "CIR019"</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="one-to-one-with-classify_ccsr_dx1">One-to-One with classify_ccsr_dx1<a class="anchor" aria-label="anchor" href="#one-to-one-with-classify_ccsr_dx1"></a>
</h2>
<p>The <code><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1()</a></code> function is similar to the other <code>classify_</code> functions used in this package, so we will begin here.</p>
<p>Although a comprehensive review of the CCSR methodology is beyond the scope of this article (I’d highly recommend reading the appendices of the <a href="https://www.hcup-us.ahrq.gov/toolssoftware/ccsr/DXCCSR-User-Guide-v2022-1.pdf" class="external-link">CCSR DX user guide</a>), I do want to highlight a few important points here.</p>
<div class="section level3">
<h3 id="only-valid-for-the-principalfirst-diagnosis">Only valid for the principal/first diagnosis<a class="anchor" aria-label="anchor" href="#only-valid-for-the-principalfirst-diagnosis"></a>
</h3>
<p>This algorithm was developed for use with the principal diagnosis (for inpatient records) or the first listed diagnosis code (for outpatient data). Consider the sample of two patients below, with their principal diagnosis listed in <code>DX1</code>, and subsequent diagnoses listed in <code>DX_n</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">Pt_id</span>,    <span class="op">~</span><span class="va">DX_1</span>,    <span class="op">~</span><span class="va">DX_2</span>,  <span class="op">~</span><span class="va">DX_3</span>,
     <span class="st">"A"</span>,    <span class="st">"I10"</span>, <span class="st">"F17210"</span>,     <span class="cn">NA</span>,
     <span class="st">"B"</span>,    <span class="st">"D62"</span>,   <span class="st">"Z370"</span>, <span class="st">"E876"</span>
  <span class="op">)</span>

<span class="co">## GOOD</span>
<span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prin_CCSR <span class="op">=</span> <span class="fu"><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1</a></span><span class="op">(</span><span class="va">DX_1</span>, setting<span class="op">=</span><span class="st">"ip"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span>
<span class="co">#&gt;   Pt_id DX_1  DX_2   DX_3  prin_CCSR</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A     I10   F17210 <span style="color: #BB0000;">NA</span>    CIR007   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B     D62   Z370   E876  BLD004</span>

<span class="co">## BAD</span>
<span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prin_CCSR <span class="op">=</span> <span class="fu"><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1</a></span><span class="op">(</span><span class="va">DX_2</span>, setting<span class="op">=</span><span class="st">"ip"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span>
<span class="co">#&gt;   Pt_id DX_1  DX_2   DX_3  prin_CCSR</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A     I10   F17210 <span style="color: #BB0000;">NA</span>    XXX000   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B     D62   Z370   E876  XXX000</span></code></pre></div>
<p>Caution should be used when working with tidy data (long-format) to avoid classifying the non-principal diagnoses</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_tidy</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols      <span class="op">=</span> <span class="op">-</span><span class="va">Pt_id</span>, 
               names_to  <span class="op">=</span> <span class="st">"DX_NUM"</span>, 
               values_to <span class="op">=</span> <span class="st">"ICD"</span><span class="op">)</span>

<span class="co">## GOOD</span>
<span class="va">df_tidy</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">DX_NUM</span><span class="op">==</span><span class="st">"DX_1"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prin_CCSR <span class="op">=</span> <span class="fu"><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1</a></span><span class="op">(</span><span class="va">ICD</span>, setting<span class="op">=</span><span class="st">"ip"</span><span class="op">)</span>,
         expln     <span class="op">=</span> <span class="fu"><a href="../reference/explain_ccsr.html">explain_ccsr</a></span><span class="op">(</span><span class="va">prin_CCSR</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span>
<span class="co">#&gt;   Pt_id DX_NUM ICD   prin_CCSR expln                       </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A     DX_1   I10   CIR007    Essential hypertension      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B     DX_1   D62   BLD004    Acute posthemorrhagic anemia</span>

<span class="co">## BAD</span>
<span class="va">df_tidy</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prin_CCSR <span class="op">=</span> <span class="fu"><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1</a></span><span class="op">(</span><span class="va">ICD</span>, setting<span class="op">=</span><span class="st">"ip"</span><span class="op">)</span>,
         expln     <span class="op">=</span> <span class="fu"><a href="../reference/explain_ccsr.html">explain_ccsr</a></span><span class="op">(</span><span class="va">prin_CCSR</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="co">#&gt;   Pt_id DX_NUM ICD    prin_CCSR expln                                           </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                           </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A     DX_1   I10    CIR007    Essential hypertension                          </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> A     DX_2   F17210 XXX000    Code is unacceptable as a principal diagnosis P…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> A     DX_3   <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>                                              </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> B     DX_1   D62    BLD004    Acute posthemorrhagic anemia                    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> B     DX_2   Z370   XXX000    Code is unacceptable as a principal diagnosis P…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> B     DX_3   E876   END011    Fluid and electrolyte disorders</span>

<span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df_tidy</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="unacceptable-principalfirst-diagnosis">Unacceptable principal/first diagnosis<a class="anchor" aria-label="anchor" href="#unacceptable-principalfirst-diagnosis"></a>
</h3>
<p>Second, not all ICD-10 codes are acceptable for default classification. For example if <strong>B95.2</strong> were listed as the Principal/First diagnoses, it would map to <code>XXX000</code> (for inpatient data) and <code>XXX111</code> (for outpatient data).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># B95.2: Enterococcus as the cause of diseases classified elsewhere</span>
<span class="fu"><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1</a></span><span class="op">(</span><span class="st">"B952"</span>, setting <span class="op">=</span> <span class="st">"inpatient"</span><span class="op">)</span>
<span class="co">#&gt; [1] "XXX000"</span>
<span class="fu"><a href="../reference/classify_ccsr_dx1.html">classify_ccsr_dx1</a></span><span class="op">(</span><span class="st">"B952"</span>, setting <span class="op">=</span> <span class="st">"outpatient"</span><span class="op">)</span>
<span class="co">#&gt; [1] "XXX111"</span></code></pre></div>
<p>This could be because B95.2 was inappropriately listed as the principal diagnosis, and if you run into this problem frequently, it may be helpful to consult the <a href="https://www.hcup-us.ahrq.gov/toolssoftware/ccsr/DXCCSR-User-Guide-v2022-1.pdf" class="external-link">CCSR DX user guide</a>.</p>
</div>
<div class="section level3">
<h3 id="setting-isnt-that-important">Setting isn’t that important<a class="anchor" aria-label="anchor" href="#setting-isnt-that-important"></a>
</h3>
<p>As of this version of the CCSR (see <code><a href="https://rdrr.io/pkg/hcup.data/man/CCSR_DX_mapping.html" class="external-link">?hcup.data::CCSR_DX_mapping</a></code> to check the version), the setting (i.e. inpatient or outpatient) doesn’t drastically change the results. Using the dataset this function is based off of, we can see that the only situations where setting = “inpatient” and setting = “outpatient” don’t agree are codes that are acceptable for the first diagnosis in the outpatient setting, not for the principal diagnosis in the inpatient setting.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu">hcup.data</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/hcup.data/man/CCSR_DX_mapping.html" class="external-link">CCSR_DX_mapping</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    
    <span class="co"># Recode the Unacceptable category to be the same for ip/op</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>default_CCSR_IP <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">default_CCSR_IP</span>, <span class="st">"XXX000"</span><span class="op">=</span><span class="st">"Unccpt"</span><span class="op">)</span>,
           default_CCSR_OP <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">default_CCSR_OP</span>, <span class="st">"XXX111"</span><span class="op">=</span><span class="st">"Unccpt"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    
    <span class="co"># Remove default categories that match across settings</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">default_CCSR_IP</span><span class="op">!=</span><span class="va">default_CCSR_OP</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">default_CCSR_IP</span>, <span class="va">default_CCSR_OP</span>, sort<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="one-to-many-with-ccsr_dx">One-to-Many with ccsr_dx()<a class="anchor" aria-label="anchor" href="#one-to-many-with-ccsr_dx"></a>
</h2>
<p><code><a href="../reference/ccsr_dx.html">ccsr_dx()</a></code> is different than most of the other functions in this package, because each ICD code can return multiple categories per ICD code. This means that we’ll be dealing with lists. To demonstrate, consider the two ICD-10 codes below:</p>
<table class="table">
<thead><tr class="header">
<th align="left">pt_id</th>
<th align="left">DX_NUM</th>
<th align="left"><code>I10_DX</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">John Doe</td>
<td align="left">1</td>
<td align="left"><code>A401</code></td>
</tr>
<tr class="even">
<td align="left">John Doe</td>
<td align="left">2</td>
<td align="left"><code>K432</code></td>
</tr>
</tbody>
</table>
<p>The code <code>A401</code> maps to two CCSR categories (<em>INF002</em> &amp; <em>INF003</em>) while <code>K432</code> only has one associated CCSR category (<em>DIG010</em>)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ccsr_dx.html">ccsr_dx</a></span><span class="op">(</span><span class="st">"A401"</span><span class="op">)</span>
<span class="co">#&gt; [1] "INF002" "INF003"</span>
<span class="fu"><a href="../reference/ccsr_dx.html">ccsr_dx</a></span><span class="op">(</span><span class="st">"K432"</span><span class="op">)</span>
<span class="co">#&gt; [1] "DIG010"</span></code></pre></div>
<p>Appending this to the previous table gives us</p>
<table class="table">
<thead><tr class="header">
<th align="left">pt_id</th>
<th align="right">DX_NUM</th>
<th align="left"><code>I10_DX</code></th>
<th align="left">CCSR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">John Doe</td>
<td align="right">1</td>
<td align="left"><code>A401</code></td>
<td align="left">INF002, INF003</td>
</tr>
<tr class="even">
<td align="left">John Doe</td>
<td align="right">2</td>
<td align="left"><code>K432</code></td>
<td align="left">DIG010</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df.listcol</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>pt_id <span class="op">=</span> <span class="st">"John Doe"</span>,
                            DX_NUM <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,
                            I10_DX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A401"</span>, <span class="st">"K432"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>CCSR <span class="op">=</span> <span class="fu"><a href="../reference/ccsr_dx.html">ccsr_dx</a></span><span class="op">(</span><span class="va">I10_DX</span><span class="op">)</span><span class="op">)</span>

<span class="va">df.listcol</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span>
<span class="co">#&gt;   pt_id    DX_NUM I10_DX CCSR     </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> John Doe      1 A401   <span style="color: #949494;">&lt;chr [2]&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> John Doe      2 K432   <span style="color: #949494;">&lt;chr [1]&gt;</span></span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df.listcol</span><span class="op">$</span><span class="va">CCSR</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ : chr [1:2] "INF002" "INF003"</span>
<span class="co">#&gt;  $ : chr "DIG010"</span></code></pre></div>
<p>The column <strong>CCSR</strong> in the table above is now a list. For those unfamiliar with list columns the book <a href="https://dcl-prog.stanford.edu/list-columns.html" class="external-link">Functional Programming</a> has a helpful overview chapter and the <a href="https://tidyr.tidyverse.org/articles/rectangle.html" class="external-link">Rectangle vignette</a> in tidyr. You can also use <code>View(df.listcol)</code> in RStudio to see the contents of the list column in a more familiar structure.</p>
<p>If you want to get this list-column into an atomic vector, <code><a href="https://tidyr.tidyverse.org/reference/hoist.html" class="external-link">tidyr::unnest_longer()</a></code> will make a new row for every element within the list</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df.listcol</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/hoist.html" class="external-link">unnest_longer</a></span><span class="op">(</span><span class="va">CCSR</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span>
<span class="co">#&gt;   pt_id    DX_NUM I10_DX CCSR  </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> John Doe      1 A401   INF002</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> John Doe      1 A401   INF003</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> John Doe      2 K432   DIG010</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-longer-example">A longer example<a class="anchor" aria-label="anchor" href="#a-longer-example"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">pt_id</span>, <span class="op">~</span><span class="va">DX_NUM</span>, <span class="op">~</span><span class="va">ICD10</span>,
  <span class="st">"A"</span>,     <span class="fl">1</span>,      <span class="st">"K432"</span>,
  <span class="st">"A"</span>,     <span class="fl">2</span>,      <span class="st">"A401"</span>,
  <span class="st">"B"</span>,     <span class="fl">1</span>,      <span class="st">"I495"</span>,
  <span class="st">"B"</span>,     <span class="fl">2</span>,   <span class="st">"BadCode"</span>,
  <span class="st">"C"</span>,     <span class="fl">1</span>,     <span class="st">"E8771"</span>,
  <span class="st">"C"</span>,     <span class="fl">2</span>,     <span class="st">"A5442"</span>,
  <span class="st">"C"</span>,     <span class="fl">3</span>,      <span class="st">"A564"</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
 <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>CCSR <span class="op">=</span> <span class="fu"><a href="../reference/ccsr_dx.html">ccsr_dx</a></span><span class="op">(</span><span class="va">ICD10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
 <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/hoist.html" class="external-link">unnest_longer</a></span><span class="op">(</span><span class="va">CCSR</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
 <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>CCSR_expl <span class="op">=</span> <span class="fu"><a href="../reference/explain_ccsr.html">explain_ccsr</a></span><span class="op">(</span><span class="va">CCSR</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 5</span></span>
<span class="co">#&gt;    pt_id DX_NUM ICD10   CCSR   CCSR_expl                                        </span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                            </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A          1 K432    DIG010 Abdominal hernia                                 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A          2 A401    INF002 Septicemia                                       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A          2 A401    INF003 Bacterial infections                             </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> B          1 I495    CIR017 Cardiac dysrhythmias                             </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> B          2 BadCode <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>                                               </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> C          1 E8771   END011 Fluid and electrolyte disorders                  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> C          2 A5442   INF010 Sexually transmitted infections (excluding HIV a…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> C          2 A5442   MUS001 Infective arthritis                              </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> C          3 A564    INF010 Sexually transmitted infections (excluding HIV a…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> C          3 A564    RSP006 Other specified upper respiratory infections</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Hunter Ratliff.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
